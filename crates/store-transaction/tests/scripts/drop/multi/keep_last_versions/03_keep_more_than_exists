# Copyright (c) reifydb.com 2025
# This file is licensed under the AGPL-3.0-or-later, see license.md file

# Tests keep_last_versions=N where N > actual versions (should be no-op).

set a=1 version=1
set a=2 version=2
set a=3 version=3
---
ok

count_versions a
---
"a" => 3 versions

# Keep last 10 but only 3 exist - should keep all 3
drop a keep_last_versions=10
---
ok

# All 3 versions still exist
count_versions a
---
"a" => 3 versions

contains a version=1
contains a version=2
contains a version=3
---
"a" => true
"a" => true
"a" => true

get a version=1
get a version=2
get a version=3
---
"a" => "1"
"a" => "2"
"a" => "3"
