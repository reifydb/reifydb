# Copyright (c) reifydb.com 2025
# This file is licensed under the AGPL-3.0-or-later, see license.md file

# Tests keep_last_versions=1 - keep only the latest version.

set a=1 version=1
set a=2 version=2
set a=3 version=3
set a=4 version=4
set a=5 version=5
---
ok

# Should have 5 versions
count_versions a
---
"a" => 5 versions

# Drop all but latest
drop a keep_last_versions=1
---
ok

# Only 1 version remains
count_versions a
---
"a" => 1 versions

# Old versions gone
contains a version=1
contains a version=2
contains a version=3
contains a version=4
---
"a" => false
"a" => false
"a" => false
"a" => false

# Latest version remains
contains a version=5
---
"a" => true

get a version=5
---
"a" => "5"
