# Copyright (c) reifydb.com 2025
# This file is licensed under the AGPL-3.0-or-later, see license.md file

# Verifies total_count = current_count + historical_count

# Insert 3 keys
set a=1
---
ok

set b=2
---
ok

set c=3
---
ok

# 3 current, 0 historical = 3 total
stats_totals
---
total_count: 3
current_bytes: 30
historical_bytes: 0
total_bytes: 30

# Update each once
set a=11
---
ok

set b=22
---
ok

set c=33
---
ok

# 3 current, 3 historical = 6 total
stats_totals
---
total_count: 6
current_bytes: 33
historical_bytes: 30
total_bytes: 63

# Delete one (moves to historical + tombstone)
remove a
---
ok

# 2 current, 5 historical = 7 total
# (3 updates + 1 deleted current + 1 tombstone)
stats_totals
---
total_count: 7
current_bytes: 22
historical_bytes: 50
total_bytes: 72
