# Copyright (c) reifydb.com 2025
# This file is licensed under the AGPL-3.0-or-later, see license.md file

# Test filter combining different data types
# String, numeric, and boolean in same condition

(command 'create schema test;')
command 'create table test.source { id: int4, name: utf8, score: float8, active: bool }'
---
> +----------+----------+-----------+
> |  schema  |  table   |  created  |
> +----------+----------+-----------+
> |   test   |  source  |   true    |
> +----------+----------+-----------+
> 

command 'create deferred view test.top_active { id: int4, name: utf8, score: float8, active: bool } as {
  from test.source
  filter { score > 75.5 and active == true and name != "Test" }
}'
---
> +----------+--------------+-----------+
> |  schema  |     view     |  created  |
> +----------+--------------+-----------+
> |   test   |  top_active  |   true    |
> +----------+--------------+-----------+
> 

# Insert mixed type data
command 'from [
  {id: 1, name: "Alice", score: 82.5, active: true},
  {id: 2, name: "Test", score: 90.0, active: true},
  {id: 3, name: "Bob", score: 75.5, active: true},
  {id: 4, name: "Charlie", score: 88.2, active: false},
  {id: 5, name: "Diana", score: 79.8, active: true},
  {id: 6, name: "Eve", score: 65.0, active: true}
] insert test.source'
---
> +----------+----------+------------+
> |  schema  |  table   |  inserted  |
> +----------+----------+------------+
> |   test   |  source  |     6      |
> +----------+----------+------------+
> 

command 'from test.source'
---
> +------+-----------+---------+----------+
> |  id  |   name    |  score  |  active  |
> +------+-----------+---------+----------+
> |  6   |    Eve    |   65    |   true   |
> |  5   |   Diana   |  79.8   |   true   |
> |  4   |  Charlie  |  88.2   |  false   |
> |  3   |    Bob    |  75.5   |   true   |
> |  2   |   Test    |   90    |   true   |
> |  1   |   Alice   |  82.5   |   true   |
> +------+-----------+---------+----------+
> 

await

# Should match all type conditions
command 'from test.top_active'
---
> +------+---------+---------+----------+
> |  id  |  name   |  score  |  active  |
> +------+---------+---------+----------+
> |  5   |  Diana  |  79.8   |   true   |
> |  1   |  Alice  |  82.5   |   true   |
> +------+---------+---------+----------+
> 
