# Copyright (c) reifydb.com 2025
# This file is licensed under the AGPL-3.0-or-later, see license.md file

# Test distinct on integer columns
# Different integer types

(command 'create schema test;')
command 'create table test.source { small: int2, medium: int4, large: int8 }'
---
> +----------+----------+-----------+
> |  schema  |  table   |  created  |
> +----------+----------+-----------+
> |   test   |  source  |   true    |
> +----------+----------+-----------+
> 

command 'create deferred view test.unique_ints { small: int2, medium: int4, large: int8 } as {
  from test.source
  distinct { medium }
}'
---
> +----------+---------------+-----------+
> |  schema  |     view      |  created  |
> +----------+---------------+-----------+
> |   test   |  unique_ints  |   true    |
> +----------+---------------+-----------+
> 

# Insert duplicate integers
command 'from [
  {small: 1, medium: 1000, large: 1000000},
  {small: 2, medium: 2000, large: 2000000},
  {small: 3, medium: 1000, large: 3000000},
  {small: 4, medium: 3000, large: 4000000},
  {small: 5, medium: 2000, large: 5000000}
] insert test.source'
---
> +----------+----------+------------+
> |  schema  |  table   |  inserted  |
> +----------+----------+------------+
> |   test   |  source  |     5      |
> +----------+----------+------------+
> 

command 'from test.source'
---
> +---------+----------+-----------+
> |  small  |  medium  |   large   |
> +---------+----------+-----------+
> |    5    |   2000   |  5000000  |
> |    4    |   3000   |  4000000  |
> |    3    |   1000   |  3000000  |
> |    2    |   2000   |  2000000  |
> |    1    |   1000   |  1000000  |
> +---------+----------+-----------+
> 

await

# Should show unique medium values
command 'from test.unique_ints'
---
> +---------+----------+-----------+
> |  small  |  medium  |   large   |
> +---------+----------+-----------+
> |    5    |   2000   |  5000000  |
> |    4    |   3000   |  4000000  |
> |    3    |   1000   |  3000000  |
> +---------+----------+-----------+
> 
