# Copyright (c) reifydb.com 2025
# This file is licensed under the AGPL-3.0-or-later, see license.md file

# Test physical plan for global aggregate without BY clause
physical 'from users aggregate { count(id) }'
---
> └── Aggregate
>     ├── Map
>     │   └── count(Column(id))
>     ├── By
>     └── Source
>         └── TableScan default.users
> 

# Test physical plan for global aggregate with empty BY clause
physical 'from users aggregate { total: count(id), sum: sum(age) } by {}'
---
> └── Aggregate
>     ├── Map
>     │   ├── count(Column(id)) as total
>     │   └── sum(Column(age)) as sum
>     ├── By
>     └── Source
>         └── TableScan default.users
> 

# Test physical plan for multiple global aggregations with aliases
physical 'from users aggregate { cnt: count(id), total: sum(age), average: avg(age), minimum: min(age), maximum: max(age) } by {}'
---
> └── Aggregate
>     ├── Map
>     │   ├── count(Column(id)) as cnt
>     │   ├── sum(Column(age)) as total
>     │   ├── avg(Column(age)) as average
>     │   ├── min(Column(age)) as minimum
>     │   └── max(Column(age)) as maximum
>     ├── By
>     └── Source
>         └── TableScan default.users
> 
