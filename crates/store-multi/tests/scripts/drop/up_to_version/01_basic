# Copyright (c) reifydb.com 2025
# This file is licensed under the AGPL-3.0-or-later, see license.md file

# Tests basic up_to_version - drop versions < threshold.

set a=1 version=1
set a=2 version=2
set a=3 version=3
set a=4 version=4
set a=5 version=5
---
ok

count_versions a
---
"a" => 5 versions

# Drop versions < 3 (should drop v1, v2)
drop a up_to_version=3
---
ok

# 3 versions remain (3, 4, 5)
count_versions a
---
"a" => 3 versions

# Versions 1, 2 are gone
contains a version=1
contains a version=2
---
"a" => false
"a" => false

# Versions 3, 4, 5 remain
contains a version=3
contains a version=4
contains a version=5
---
"a" => true
"a" => true
"a" => true

get a version=3
get a version=4
get a version=5
---
"a" => "3"
"a" => "4"
"a" => "5"
