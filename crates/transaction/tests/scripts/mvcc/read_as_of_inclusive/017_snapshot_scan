# Copyright (c) reifydb.com 2025
# This file is licensed under the AGPL-3.0-or-later, see license.md file

# Test scan operations at different versions

# Build version history
import a=1 b=2
---
ok

t1: begin
t1: set c=3
t1: commit
---
ok

t2: begin
t2: set d=4
t2: commit
---
ok

t3: begin
t3: remove b
t3: set e=5
t3: commit
---
ok

# Scan at each version
t4: begin
t4: set_as_of_inclusive 1
t4: scan
---
t4: "a" => "1"
t4: "b" => "2"

t4: set_as_of_inclusive 2
t4: scan
---
t4: "a" => "1"
t4: "b" => "2"
t4: "c" => "3"

t4: set_as_of_inclusive 3
t4: scan
---
t4: "a" => "1"
t4: "b" => "2"
t4: "c" => "3"
t4: "d" => "4"

t4: set_as_of_inclusive 4
t4: scan
---
t4: "a" => "1"
t4: "c" => "3"
t4: "d" => "4"
t4: "e" => "5"

# Reverse scan at version 3
t5: begin
t5: set_as_of_inclusive 3
t5: scan
---
t5: "a" => "1"
t5: "b" => "2"
t5: "c" => "3"
t5: "d" => "4"
