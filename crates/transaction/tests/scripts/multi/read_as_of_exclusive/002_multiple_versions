# Copyright (c) reifydb.com 2025
# This file is licensed under the AGPL-3.0-or-later, see license.md file

# Test reading different data at multiple versions in sequence

# Create version history
import a=1
---
ok

t1: begin
t1: set a=2
t1: commit
---
ok

t2: begin
t2: set a=3
t2: commit
---
ok

t3: begin
t3: set a=4
t3: commit
---
ok

# Single transaction reading at different versions
t4: begin
t4: get a
---
t4: "a" => "4"

# Go back to version 3 (sees version 2 data)
t4: set_as_of_exclusive 3
t4: get a
---
t4: "a" => "2"

# Go back to version 2 (sees version 1 data)
t4: set_as_of_exclusive 2
t4: get a
---
t4: "a" => "1"

# Go back to version 1 (sees no data - no versions < 1)
t4: set_as_of_exclusive 1
t4: get a
---
t4: "a" => None

# Go forward to version 4 (sees version 3 data)
t4: set_as_of_exclusive 4
t4: get a
---
t4: "a" => "3"
