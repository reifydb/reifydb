# Copyright (c) reifydb.com 2025
# This file is licensed under the AGPL-3.0-or-later, see license.md file

# Tests dropping multiple versions at once.

# Create 5 versions
set a=1 version=1
---
ok

set a=2 version=2
---
ok

set a=3 version=3
---
ok

set a=4 version=4
---
ok

set a=5 version=5
---
ok

# Historical has 4 versions
stats_historical
---
historical_count: 4
historical_key_bytes: 44
historical_value_bytes: 4

# Drop versions < 4 (should drop v1, v2, v3)
drop a up_to_version=4 version=6
---
ok

# Historical should now have 1 version (v4)
stats_historical
---
historical_count: 1
historical_key_bytes: 11
historical_value_bytes: 1

# Current unchanged (v5)
stats_current
---
current_count: 1
current_key_bytes: 11
current_value_bytes: 1
