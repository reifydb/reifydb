# SPDX-License-Identifier: AGPL-3.0-or-later
# Copyright (c) 2025 ReifyDB

# Test multi-stage pipeline
parse 'FROM users | FILTER age > 18 | MAP { name, age } | SORT { name } | TAKE 10'
---
> Program:
>   [  0] Statement::Pipeline
>     [  0] Expr::From(Source("users"))
>     [  1] Expr::Filter
>       Expr::Binary(Gt)
>         left:
>           Expr::Identifier("age")
>         right:
>           Expr::Literal(Integer(18))
>     [  2] Expr::Map
>       [  0] Expr::Identifier("name")
>       [  1] Expr::Identifier("age")
>     [  3] Expr::Sort
>       [  0] SortColumn
>         Expr::Identifier("name")
>     [  4] Expr::Take
>       Expr::Literal(Integer(10))
>
