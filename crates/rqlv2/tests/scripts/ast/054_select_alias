# SPDX-License-Identifier: AGPL-3.0-or-later
# Copyright (c) 2025 ReifyDB

# Test SELECT as alias for MAP - single column
parse 'FROM users | SELECT { name }'
---
> Program
> `-- [0] Pipeline
>     +-- [0] From(default.users)
>     `-- [1] Map
>         `-- [0] Identifier(name)
>

# Test SELECT with multiple columns
parse 'FROM users | SELECT { name, age }'
---
> Program
> `-- [0] Pipeline
>     +-- [0] From(default.users)
>     `-- [1] Map
>         +-- [0] Identifier(name)
>         `-- [1] Identifier(age)
>

# Test SELECT with wildcard
parse 'FROM users | SELECT { * }'
---
> Program
> `-- [0] Pipeline
>     +-- [0] From(default.users)
>     `-- [1] Map
>         `-- [0] Wildcard
>

# Test SELECT with aliases using key: value syntax
parse 'FROM users | SELECT { n: name, a: age }'
---
> Program
> `-- [0] Pipeline
>     +-- [0] From(default.users)
>     `-- [1] Map
>         +-- [0] Binary(KeyValue)
>         |   +-- left: Identifier(n)
>         |   `-- right: Identifier(name)
>         `-- [1] Binary(KeyValue)
>             +-- left: Identifier(a)
>             `-- right: Identifier(age)
>

# Test SELECT with computed expression and alias
parse 'FROM data | SELECT { total: price * quantity }'
---
> Program
> `-- [0] Pipeline
>     +-- [0] From(default.data)
>     `-- [1] Map
>         `-- [0] Binary(KeyValue)
>             +-- left: Identifier(total)
>             `-- right: Binary(Mul)
>                 +-- left: Identifier(price)
>                 `-- right: Identifier(quantity)
>

# Test SELECT with mixed columns and aliases
parse 'FROM orders | SELECT { id, total: price * quantity, status }'
---
> Program
> `-- [0] Pipeline
>     +-- [0] From(default.orders)
>     `-- [1] Map
>         +-- [0] Identifier(id)
>         +-- [1] Binary(KeyValue)
>         |   +-- left: Identifier(total)
>         |   `-- right: Binary(Mul)
>         |       +-- left: Identifier(price)
>         |       `-- right: Identifier(quantity)
>         `-- [2] Identifier(status)
>
