# SPDX-License-Identifier: AGPL-3.0-or-later
# Copyright (c) 2025 ReifyDB

# Test MAP with multiple columns
parse 'FROM users | MAP { name, age }'
---
> Program
> `-- [0] Pipeline
>     +-- [0] From(default.users)
>     `-- [1] Map
>         +-- [0] Identifier(name)
>         `-- [1] Identifier(age)
>

# Test MAP with single column in braces
parse 'FROM users | MAP { name }'
---
> Program
> `-- [0] Pipeline
>     +-- [0] From(default.users)
>     `-- [1] Map
>         `-- [0] Identifier(name)
>

# Test MAP with wildcard
parse 'FROM users | MAP { * }'
---
> Program
> `-- [0] Pipeline
>     +-- [0] From(default.users)
>     `-- [1] Map
>         `-- [0] Wildcard
>

# Test MAP with constant number
parse 'FROM data | MAP { 42 }'
---
> Program
> `-- [0] Pipeline
>     +-- [0] From(default.data)
>     `-- [1] Map
>         `-- [0] Integer(42)
>

# Test MAP with arithmetic expression
parse 'FROM data | MAP { 1 + 2 }'
---
> Program
> `-- [0] Pipeline
>     +-- [0] From(default.data)
>     `-- [1] Map
>         `-- [0] Binary(Add)
>             +-- left: Integer(1)
>             `-- right: Integer(2)
>

# Test MAP with three columns
parse 'FROM users | MAP { id, name, email }'
---
> Program
> `-- [0] Pipeline
>     +-- [0] From(default.users)
>     `-- [1] Map
>         +-- [0] Identifier(id)
>         +-- [1] Identifier(name)
>         `-- [2] Identifier(email)
>
