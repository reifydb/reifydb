# SPDX-License-Identifier: AGPL-3.0-or-later
# Copyright (c) 2025 ReifyDB

# Test MAP with multiple computed expressions
parse 'FROM data | MAP { 1 + 2, 4 * 3 }'
---
> Program
> `-- [0] Pipeline
>     +-- [0] From(default.data)
>     `-- [1] Map
>         +-- [0] Binary(Add)
>         |   +-- left: Integer(1)
>         |   `-- right: Integer(2)
>         `-- [1] Binary(Mul)
>             +-- left: Integer(4)
>             `-- right: Integer(3)
>

# Test MAP mixing plain columns and aliases
parse 'FROM orders | MAP { name, total: price * quantity, status }'
---
> Program
> `-- [0] Pipeline
>     +-- [0] From(default.orders)
>     `-- [1] Map
>         +-- [0] Identifier(name)
>         +-- [1] Binary(KeyValue)
>         |   +-- left: Identifier(total)
>         |   `-- right: Binary(Mul)
>         |       +-- left: Identifier(price)
>         |       `-- right: Identifier(quantity)
>         `-- [2] Identifier(status)
>

# Test MAP with multiple aliases
parse 'FROM users | MAP { first: fname, last: lname, full: concat(fname, lname) }'
---
> Program
> `-- [0] Pipeline
>     +-- [0] From(default.users)
>     `-- [1] Map
>         +-- [0] Binary(KeyValue)
>         |   +-- left: Identifier(first)
>         |   `-- right: Identifier(fname)
>         +-- [1] Binary(KeyValue)
>         |   +-- left: Identifier(last)
>         |   `-- right: Identifier(lname)
>         `-- [2] Binary(KeyValue)
>             +-- left: Identifier(full)
>             `-- right: Call(concat)
>                 `-- args:
>                     +-- [0] Identifier(fname)
>                     `-- [1] Identifier(lname)
>

# Test MAP with many columns
parse 'FROM products | MAP { id, name, price, stock, category }'
---
> Program
> `-- [0] Pipeline
>     +-- [0] From(default.products)
>     `-- [1] Map
>         +-- [0] Identifier(id)
>         +-- [1] Identifier(name)
>         +-- [2] Identifier(price)
>         +-- [3] Identifier(stock)
>         `-- [4] Identifier(category)
>
