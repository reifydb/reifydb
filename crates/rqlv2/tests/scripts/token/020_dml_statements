# SPDX-License-Identifier: AGPL-3.0-or-later
# Copyright (c) 2025 ReifyDB

# Test DML statements (INSERT, UPDATE, DELETE) using RQL pipeline syntax

# Simple insert
tokenize 'from [{ name: "Alice" }] insert users'
---
> Line 1:
>   [  0] Keyword(From)
>   [  1] Punctuation(OpenBracket)
>   [  2] Punctuation(OpenCurly)
>   [  3] Identifier("name")
>   [  4] Operator(Colon)
>   [  5] Literal(String("Alice"))
>   [  6] Punctuation(CloseCurly)
>   [  7] Punctuation(CloseBracket)
>   [  8] Keyword(Insert)
>   [  9] Identifier("users")
>   [ 10] EOF
>
>

# Insert with multiple fields
tokenize 'from [{ name: "Alice", age: 30 }] insert users'
---
> Line 1:
>   [  0] Keyword(From)
>   [  1] Punctuation(OpenBracket)
>   [  2] Punctuation(OpenCurly)
>   [  3] Identifier("name")
>   [  4] Operator(Colon)
>   [  5] Literal(String("Alice"))
>   [  6] Punctuation(Comma)
>   [  7] Identifier("age")
>   [  8] Operator(Colon)
>   [  9] Literal(Integer(30))
>   [ 10] Punctuation(CloseCurly)
>   [ 11] Punctuation(CloseBracket)
>   [ 12] Keyword(Insert)
>   [ 13] Identifier("users")
>   [ 14] EOF
>
>

# Update with filter and map
tokenize 'from users filter id == 1 map { id, name: "John" } update users'
---
> Line 1:
>   [  0] Keyword(From)
>   [  1] Identifier("users")
>   [  2] Keyword(Filter)
>   [  3] Identifier("id")
>   [  4] Operator(DoubleEqual)
>   [  5] Literal(Integer(1))
>   [  6] Keyword(Map)
>   [  7] Punctuation(OpenCurly)
>   [  8] Identifier("id")
>   [  9] Punctuation(Comma)
>   [ 10] Identifier("name")
>   [ 11] Operator(Colon)
>   [ 12] Literal(String("John"))
>   [ 13] Punctuation(CloseCurly)
>   [ 14] Keyword(Update)
>   [ 15] Identifier("users")
>   [ 16] EOF
>
>

# Delete with filter
tokenize 'from users filter id == 1 delete users'
---
> Line 1:
>   [  0] Keyword(From)
>   [  1] Identifier("users")
>   [  2] Keyword(Filter)
>   [  3] Identifier("id")
>   [  4] Operator(DoubleEqual)
>   [  5] Literal(Integer(1))
>   [  6] Keyword(Delete)
>   [  7] Identifier("users")
>   [  8] EOF
>
>

# Update with boolean value
tokenize 'from users filter id == 1 map { id, active: false } update users'
---
> Line 1:
>   [  0] Keyword(From)
>   [  1] Identifier("users")
>   [  2] Keyword(Filter)
>   [  3] Identifier("id")
>   [  4] Operator(DoubleEqual)
>   [  5] Literal(Integer(1))
>   [  6] Keyword(Map)
>   [  7] Punctuation(OpenCurly)
>   [  8] Identifier("id")
>   [  9] Punctuation(Comma)
>   [ 10] Identifier("active")
>   [ 11] Operator(Colon)
>   [ 12] Literal(False)
>   [ 13] Punctuation(CloseCurly)
>   [ 14] Keyword(Update)
>   [ 15] Identifier("users")
>   [ 16] EOF
>
>
