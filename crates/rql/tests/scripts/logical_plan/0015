# Copyright (c) reifydb.com 2025
# This file is licensed under the AGPL-3.0-or-later, see license.md file

# Test logical plan for global aggregate without BY clause
logical 'from users aggregate { count(id) }'
---
> └── TableScan default.users
> └── Aggregate
>     ├── Map
>     │   └── count(id)
>     └── By
> 

# Test logical plan for global aggregate with empty BY clause
logical 'from users aggregate { total: count(id), sum: sum(amount) } by {}'
---
> └── TableScan default.users
> └── Aggregate
>     ├── Map
>     │   ├── count(id) as total
>     │   └── sum(amount) as sum
>     └── By
> 

# Test logical plan for multiple global aggregations
logical 'from users aggregate { count(id), sum(amount), avg(price), min(age), max(age) } by {}'
---
> └── TableScan default.users
> └── Aggregate
>     ├── Map
>     │   ├── count(id)
>     │   ├── sum(amount)
>     │   ├── avg(price)
>     │   ├── min(age)
>     │   └── max(age)
>     └── By
> 
