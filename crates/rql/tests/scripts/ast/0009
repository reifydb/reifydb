# Copyright (c) reifydb.com 2025
# This file is licensed under the AGPL-3.0-or-later, see license.md file

# Test AST for global aggregate without BY clause
ast 'aggregate { count(value) }'
---
> └── Aggregate @ line 1, column 1 — "aggregate"
>     ├── Aggregate Map
>     │   └── CallFunction @ line 1, column 13 — "count"
>

# Test AST for global aggregate with empty BY clause
ast 'aggregate { sum(amount), avg(price) } by {}'
---
> └── Aggregate @ line 1, column 1 — "aggregate"
>     ├── Aggregate Map
>     │   ├── CallFunction @ line 1, column 13 — "sum"
>     │   └── CallFunction @ line 1, column 26 — "avg"
>

# Test AST for global aggregate with aliases (colon syntax is converted to expr AS alias)
ast 'from users aggregate { total: count(id), average: avg(age) } by {}'
---
> └── From @ line 1, column 1 — "from"
>     └── Identifier @ line 1, column 6 — "users"
> └── Aggregate @ line 1, column 12 — "aggregate"
>     ├── Aggregate Map
>     │   ├── Infix @ line 1, column 31 — "count"
>     │   │   ├── CallFunction @ line 1, column 31 — "count"
>     │   │   └── Identifier @ line 1, column 24 — "total"
>     │   └── Infix @ line 1, column 51 — "avg"
>     │       ├── CallFunction @ line 1, column 51 — "avg"
>     │       └── Identifier @ line 1, column 42 — "average"
>
